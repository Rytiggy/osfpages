{{#if isAdmin}}
{{loading-spinner isLoading=isLoading}}

    <div class="editMenu">
        <div class="container p-sm">
            <div class="row">
                <div class="col-xs-2">
                    {{#if editMode}}
                        {{layer-template-select theme=model.theme}}
                    {{/if}}
                </div>
                <div class="col-xs-2">
                {{#if editMode}}
                    <button class="btn-outline-white-cus" disabled="{{unless model.theme.canUndo 'disabled'}}" {{action 'undo'}}><i class="material-icons">undo</i></button>
                    <button class="btn-outline-white-cus" disabled="{{unless model.theme.canRedo 'disabled'}}" {{action 'redo'}}><i class="material-icons">redo</i></button>
                {{/if}}
                </div>
                <div class="col-xs-3">
                {{#if saved}}
                   <div class="text-center"> Saving...</div>
                {{/if}}
                {{#if published}}
                    <div class="text-center">Publishing...</div>
                {{/if}}
                {{#if unpublishedChanges}}
                    <div class="text-center"> Unpublished draft
                        {{#unless editMode}}
                            <a href='' style='color: #96c3ea' {{action 'toggleEditMode'}}> edit now</a>
                        {{/unless}}
                        </div>
                {{/if}}
                </div>
                <div class="col-xs-3">
                    {{#if editMode}}
                    <div class="pull-right">
                        <button class="btn-outline-white-cus" {{action 'publish'}}>
                            <i class="material-icons">publish</i>
                            <span> Publish</span>
                        </button>
                        <button class="btn-outline-white-cus" {{action 'save'}}>
                            <i class="material-icons">save</i>
                            <span> Save draft</span>
                         </button>
                    </div>
                    {{/if}}
                </div>
                <div class="col-xs-2 clearfix">
                    <div class="pull-right">
                        <button class="btn-outline-white-cus editModeBtn" {{action 'checkSaveState'}}  title="Edit Mode">
                            {{#if editMode}}
                                <i class="material-icons">close</i><span>Finish editing </span> 
                            {{else}}
                                <i class="material-icons">edit</i> Edit
                            {{/if}}
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {{#if editMode}}
        <div class="edit-Mode-View">

            <div class="row">
                <div class="col-xs-8 sublime-view-scroll">
                <div class="site-overview">
                    <h3 class="text-center">Site Map</h3>
                    {{#each model.theme.layers as |layer index|}}
                        <div 
                            class="page-overview-block" 
                            style='
                            background: {{layer.settings.bgColor}}; 
                            background-image: url("{{layer.settings.backgroundImage}}"); 
                            color:{{layer.settings.color}};
                            background-size: 100%;'
                            {{action 'scrollToLayer' index}}
                            >
                            {{#if layer.settings.lead}}
                                {{model.node.title}}
                            {{/if}}

                            {{layer.settings.sectionTitle}}
                            <div class="ss-text">{{layer.content.content}}</div>
                            {{#if layer.settings.downloadLink}}
                                <div class="fake-file-view">
                                </div>
                            {{/if}}
                            {{#if layer.settings.backgroundImage}}
                                <div class="background-image-size">
                                </div>
                            {{/if}}
                            

                        </div>
                        {{add-layer index=index layers=model.theme.layers type=type mini=true styles=styles }}

                    {{/each}}
                </div>
                </div>
                <div class="col-xs-4 add-layer-side-view">            
                    {{add-layer index=index layers=model.theme.layers sideView=true type=type styles=styles}}
                </div>
            </div>
        </div>
    {{/if}}
    {{#if isOpen}}
         <div class="alert alert-warning alert-message">
            <strong>Warning!</strong> This OSF project is <strong>not public </strong> and can not be viewed by others.<br /> Please consider making this project public!<br />
              <a href="http://osf.io/{{model.guid}}"  type="button" class="btn btn-secondary pull-right btn-outline-cus-black" > Make public</a>
        </div>
    {{/if}}

{{/if}}

<div class="holder" >

    {{#if model.theme.layers}}
    
    <div>

        {{#each model.theme.layers as |layer index|}}
            <div class="row"  style="padding:0">
            {{#if editMode}}
                <div  class="col-xs-3">

                </div>
            {{/if}}
                <div class="{{holderCSSEditMode}}" style="padding:0">
                    <div class="layer clearfix">

                        {{layer-wrapper node=model.node layer=layer layers=model.theme.layers editMode=editMode index=index}}
                        {{#if editMode}}
                        {{add-layer index=index layers=model.theme.layers type=type style="min-height:2px;"}}
                        {{/if}}

                    </div>
                </div>
            </div>
        {{/each}}
     
    </div>

    {{else}}
        {{add-layer index=index layers=model.theme.layers}}
    {{/if}}

    {{layer-footer guid=model.guid editMode=editMode holderCSSEditMode=holderCSSEditMode}}
</div>


<div class="scroll-top" {{action 'scrollToTop'}}>{{fa-icon 'angle-up'}}</div>

{{#if showNotSavedModal}}
    {{#bs-modal onSubmit=(action "toggleEditMode" true) onHidden=(action 'toggleModal' false) as |modal|}}
        {{#modal.header}}
            <h4 class="modal-title">You have unsaved/unpublished changes, do you want to save them?</h4>
        {{/modal.header}}
        {{#modal.footer as |footer|}}
            {{#bs-button onClick=(action 'toggleEditMode') type="normal"}}Discard changes{{/bs-button}}
            {{#bs-button onClick=(action modal.submit) type="success"}}Save{{/bs-button}}
        {{/modal.footer}}
    {{/bs-modal}}
{{/if}}

